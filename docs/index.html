<html>

<head>
  <title>Ejecutor de Consultas</title>
  <style>
    body {
      background-color: black;
      color: white;
    }

    code:not(.language-diff) {
      background-color: white;
      color: black;
      display: inline-block;
    }

    code.language-diff {
      background-color: while;
      color: green;
    }
  </style>
</head>

<body>
<h1>Ejecutor de Consultas SQL para Oracle</h1>
<p>Script automatizado en PowerShell para ejecutar m√∫ltiples consultas SQL en Oracle utilizando <strong>Oracle SQLcl</strong> y exportar los resultados a CSV o XLSX (Excel). Incluye validaci√≥n de solo consultas SELECT, par√°metros din√°micos y opciones de contrase√±a seguras.</p>
<h2>üìã Requisitos Previos</h2>
<h3>1. Sistema Operativo</h3>
<ul>
<li>Windows 10 o superior con PowerShell 5.1 o superior</li>
</ul>
<h3>2. PowerShell - Verificaci√≥n de Versi√≥n</h3>
<p>Para verificar su versi√≥n de PowerShell:</p>
<ol>
<li>Abra PowerShell (Inicio &gt; escriba &quot;PowerShell&quot;)</li>
<li>Ejecute: <code>$PSVersionTable.PSVersion</code></li>
<li>Debe mostrar versi√≥n 5.1 o superior</li>
</ol>
<h3>3. Java Runtime Environment (JRE) o Java Development Kit (JDK)</h3>
<p><strong>Oracle SQLcl requiere Java 17 o superior</strong> para funcionar. Debe tener instalado Java Runtime Environment (JRE) o Java Development Kit (JDK) versi√≥n <strong>17.0.5 o superior</strong>.</p>
<h4>Verificar si Java est√° Instalado</h4>
<p>Abra PowerShell o CMD y ejecute:</p>
<pre><code class="language-powershell">java -version
</code></pre>
<p>Si Java est√° instalado, ver√° algo como:</p>
<pre><code>java version &quot;17.0.9&quot; 2023-10-17 LTS
Java(TM) SE Runtime Environment (build 17.0.9+11-LTS-201)
</code></pre>
<p>Si muestra un error o una versi√≥n menor a 17, necesita instalar o actualizar Java.</p>
<h4>Descargar e Instalar Java</h4>
<h5><strong>Opci√≥n 1: Oracle JDK (Recomendado para uso comercial)</strong></h5>
<ol>
<li>
<p><strong>Descargar Oracle JDK:</strong></p>
<ul>
<li>Visite: https://www.oracle.com/java/technologies/downloads/</li>
<li>Seleccione <strong>Java 17</strong> o superior (Java 25 es la versi√≥n LTS m√°s reciente)</li>
<li>En la secci√≥n &quot;Windows&quot;, descargue el instalador:
<ul>
<li><strong>x64 Installer</strong> (archivo <code>.exe</code>) para Windows 64-bit</li>
<li>Tama√±o aproximado: 150-200 MB</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Instalar Oracle JDK:</strong></p>
<ul>
<li>Ejecute el instalador descargado (<code>.exe</code>)</li>
<li>Siga el asistente de instalaci√≥n</li>
<li>Anote la ruta de instalaci√≥n (por defecto: <code>C:\Program Files\Java\jdk-17</code> o similar)</li>
<li>Complete la instalaci√≥n</li>
</ul>
</li>
</ol>
<h5><strong>Opci√≥n 2: OpenJDK (Gratuito y de c√≥digo abierto)</strong></h5>
<ol>
<li>
<p><strong>Descargar OpenJDK:</strong></p>
<ul>
<li>Visite: https://adoptium.net/ (Eclipse Temurin)</li>
<li>Seleccione:
<ul>
<li><strong>Version:</strong> Java 17 (LTS) o superior</li>
<li><strong>Operating System:</strong> Windows</li>
<li><strong>Architecture:</strong> x64</li>
</ul>
</li>
<li>Click en &quot;Download JDK&quot;</li>
<li>Tama√±o aproximado: 100-150 MB</li>
</ul>
</li>
<li>
<p><strong>Instalar OpenJDK:</strong></p>
<ul>
<li>Ejecute el instalador descargado (<code>.msi</code>)</li>
<li>Durante la instalaci√≥n, aseg√∫rese de marcar:
<ul>
<li>‚úÖ <strong>&quot;Set JAVA_HOME variable&quot;</strong></li>
<li>‚úÖ <strong>&quot;Add to PATH&quot;</strong></li>
</ul>
</li>
<li>Complete la instalaci√≥n</li>
</ul>
</li>
</ol>
<h5><strong>Opci√≥n 3: Microsoft Build of OpenJDK</strong></h5>
<ol>
<li>
<p><strong>Descargar Microsoft OpenJDK:</strong></p>
<ul>
<li>Visite: https://learn.microsoft.com/en-us/java/openjdk/download</li>
<li>Seleccione <strong>Java 17 LTS</strong> o superior</li>
<li>Descargue el instalador <code>.msi</code> para Windows x64</li>
<li>Tama√±o aproximado: 100-150 MB</li>
</ul>
</li>
<li>
<p><strong>Instalar:</strong></p>
<ul>
<li>Ejecute el instalador <code>.msi</code></li>
<li>Siga el asistente de instalaci√≥n</li>
<li>Complete la instalaci√≥n</li>
</ul>
</li>
</ol>
<h4>Configurar Variables de Entorno de Java</h4>
<p>Si el instalador no configur√≥ autom√°ticamente las variables de entorno, debe hacerlo manualmente:</p>
<h5><strong>Paso 1: Configurar JAVA_HOME</strong></h5>
<ol>
<li>
<p><strong>Abrir Variables de Entorno:</strong></p>
<ul>
<li>Presione <code>Win + R</code></li>
<li>Escriba: <code>sysdm.cpl</code></li>
<li>Presione ENTER</li>
<li>Click en la pesta√±a <strong>&quot;Opciones avanzadas&quot;</strong></li>
<li>Click en <strong>&quot;Variables de entorno...&quot;</strong></li>
</ul>
</li>
<li>
<p><strong>Crear/Editar JAVA_HOME:</strong></p>
<ul>
<li>En la secci√≥n <strong>&quot;Variables del sistema&quot;</strong>, click en <strong>&quot;Nueva...&quot;</strong> (o &quot;Editar...&quot; si ya existe)</li>
<li><strong>Nombre de la variable:</strong> <code>JAVA_HOME</code></li>
<li><strong>Valor de la variable:</strong> Ruta donde instal√≥ Java
<ul>
<li>Oracle JDK: <code>C:\Program Files\Java\jdk-17</code></li>
<li>OpenJDK (Adoptium): <code>C:\Program Files\Eclipse Adoptium\jdk-17.0.9.9-hotspot</code></li>
<li>Microsoft OpenJDK: <code>C:\Program Files\Microsoft\jdk-17.0.9.9-hotspot</code></li>
</ul>
</li>
<li>Click <strong>&quot;Aceptar&quot;</strong></li>
</ul>
</li>
</ol>
<h5><strong>Paso 2: Agregar Java al PATH</strong></h5>
<ol>
<li><strong>Editar la Variable PATH:</strong>
<ul>
<li>En <strong>&quot;Variables del sistema&quot;</strong>, busque la variable <strong><code>Path</code></strong></li>
<li>Selecci√≥nela y click en <strong>&quot;Editar...&quot;</strong></li>
<li>Click en <strong>&quot;Nuevo&quot;</strong></li>
<li>Agregue: <code>%JAVA_HOME%\bin</code></li>
<li>Click <strong>&quot;Aceptar&quot;</strong> en todas las ventanas</li>
</ul>
</li>
</ol>
<h5><strong>Paso 3: Verificar la Configuraci√≥n</strong></h5>
<ol>
<li>
<p><strong>Abra una NUEVA ventana de PowerShell o CMD</strong> (importante para que cargue las nuevas variables)</p>
</li>
<li>
<p><strong>Verifique JAVA_HOME:</strong></p>
<pre><code class="language-powershell">echo $env:JAVA_HOME
</code></pre>
<p>Deber√≠a mostrar: <code>C:\Program Files\Java\jdk-17</code> (o la ruta que configur√≥)</p>
</li>
<li>
<p><strong>Verifique Java:</strong></p>
<pre><code class="language-powershell">java -version
</code></pre>
<p>Deber√≠a mostrar la versi√≥n de Java instalada (17 o superior)</p>
</li>
</ol>
<h4>Soluci√≥n de Problemas con Java</h4>
<h5>Java no se reconoce despu√©s de instalar</h5>
<p><strong>Soluci√≥n:</strong></p>
<ul>
<li>Cierre TODAS las ventanas de PowerShell/CMD abiertas</li>
<li>Abra una NUEVA ventana de PowerShell</li>
<li>Ejecute: <code>java -version</code></li>
</ul>
<h5>Error: &quot;JAVA_HOME no est√° definido&quot;</h5>
<p><strong>Soluci√≥n:</strong></p>
<ul>
<li>Verifique que configur√≥ JAVA_HOME correctamente</li>
<li>Aseg√∫rese de usar la ruta completa hasta la carpeta principal de Java</li>
<li>No incluya <code>\bin</code> en JAVA_HOME, solo en PATH</li>
</ul>
<h5>Versi√≥n incorrecta de Java</h5>
<p>Si tiene m√∫ltiples versiones de Java instaladas:</p>
<ol>
<li>Verifique cu√°l est√° en PATH: <code>where java</code></li>
<li>Aseg√∫rese de que JAVA_HOME apunte a Java 17 o superior</li>
<li>Edite PATH para que <code>%JAVA_HOME%\bin</code> est√© al INICIO de la lista</li>
</ol>
<h3>4. Oracle SQLcl</h3>
<p><strong>Oracle SQLcl</strong> es la herramienta de l√≠nea de comandos moderna de Oracle que reemplaza a SQL*Plus. Es gratuita, ligera y no requiere instalaci√≥n completa de Oracle Client.</p>
<h4>¬øQu√© es SQLcl?</h4>
<p>SQLcl (SQL Command Line) es:</p>
<ul>
<li>‚úÖ Gratuito y de libre uso</li>
<li>‚úÖ Multiplataforma (Windows, Linux, Mac)</li>
<li>‚úÖ Moderno y con m√°s funcionalidades que SQL*Plus</li>
<li>‚úÖ No requiere instalaci√≥n de Oracle Client completo</li>
<li>‚úÖ Incluye soporte para CSV y Excel (XLSX)</li>
<li>‚ö†Ô∏è <strong>Requiere Java 17 o superior</strong> (no incluido)</li>
</ul>
<h4>Descarga e Instalaci√≥n de SQLcl</h4>
<h5><strong>Paso 1: Descargar SQLcl</strong></h5>
<ol>
<li>Visite: https://www.oracle.com/database/sqldeveloper/technologies/sqlcl/download/</li>
<li>Descargue la versi√≥n m√°s reciente (archivo <code>.zip</code>)</li>
<li><strong>No requiere cuenta de Oracle</strong> para la descarga b√°sica</li>
</ol>
<p><strong>Tama√±o aproximado:</strong> 20-30 MB</p>
<h5><strong>Paso 2: Instalar SQLcl</strong></h5>
<ol>
<li>
<p><strong>Extraer el archivo ZIP:</strong></p>
<ul>
<li>Click derecho en el archivo descargado &gt; &quot;Extraer todo...&quot;</li>
<li>Extraiga a una ubicaci√≥n permanente, por ejemplo:
<ul>
<li><code>C:\oracle\sqlcl\</code></li>
<li><code>C:\Program Files\Oracle\sqlcl\</code></li>
<li><code>%USERPROFILE%\sqlcl\</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Estructura despu√©s de extraer:</strong></p>
<pre><code>C:\oracle\sqlcl\
‚îú‚îÄ‚îÄ bin\
‚îÇ   ‚îú‚îÄ‚îÄ sql.exe          ‚Üê Ejecutable principal
‚îÇ   ‚îî‚îÄ‚îÄ sql.bat
‚îú‚îÄ‚îÄ lib\
‚îî‚îÄ‚îÄ LICENSE.txt
</code></pre>
</li>
</ol>
<h5><strong>Paso 3: Verificar la Instalaci√≥n</strong></h5>
<p>Abra PowerShell o CMD y ejecute:</p>
<p><strong>Opci√≥n A - Si est√° en PATH:</strong></p>
<pre><code class="language-powershell">sql -V
</code></pre>
<p><strong>Opci√≥n B - Ruta completa:</strong></p>
<pre><code class="language-powershell">C:\oracle\sqlcl\bin\sql.exe -V
</code></pre>
<p>Deber√≠a mostrar algo como:</p>
<pre><code>SQLcl: Release 23.4 Production
Build: 23.4.0.341.0944
</code></pre>
<p>Si recibe un error sobre Java, aseg√∫rese de que:</p>
<ul>
<li>Java 17 o superior est√° instalado</li>
<li>JAVA_HOME est√° configurado correctamente</li>
<li><code>%JAVA_HOME%\bin</code> est√° en PATH</li>
</ul>
<h5><strong>Paso 4 (Opcional): Agregar SQLcl al PATH</strong></h5>
<p>Para ejecutar <code>sql</code> desde cualquier ubicaci√≥n:</p>
<ol>
<li>
<p><strong>Abra &quot;Variables de entorno&quot;:</strong></p>
<ul>
<li>Presione <code>Win + R</code></li>
<li>Escriba: <code>sysdm.cpl</code></li>
<li>Click en &quot;Variables de entorno...&quot;</li>
</ul>
</li>
<li>
<p><strong>Editar PATH:</strong></p>
<ul>
<li>En &quot;Variables del sistema&quot;, busque <code>Path</code></li>
<li>Click en &quot;Editar...&quot;</li>
<li>Click en &quot;Nuevo&quot;</li>
<li>Agregue: <code>C:\oracle\sqlcl\bin</code> (ajuste seg√∫n su ruta)</li>
<li>Click &quot;Aceptar&quot; en todas las ventanas</li>
</ul>
</li>
<li>
<p><strong>Verificar:</strong></p>
<ul>
<li>Abra una <strong>nueva</strong> ventana de PowerShell</li>
<li>Ejecute: <code>sql -V</code></li>
</ul>
</li>
</ol>
<h4>Rutas Buscadas por el Script</h4>
<p>El script buscar√° autom√°ticamente SQLcl en:</p>
<ul>
<li><code>C:\oracle\sqlcl\bin\sql.exe</code></li>
<li><code>C:\Program Files\Oracle\sqlcl\bin\sql.exe</code></li>
<li><code>%USERPROFILE%\sqlcl\bin\sql.exe</code></li>
<li><code>%ORACLE_HOME%\sqlcl\bin\sql.exe</code></li>
<li>Variable <code>PATH</code> del sistema</li>
</ul>
<h3>5. Microsoft Excel (Solo para exportar a XLSX)</h3>
<p>Si desea exportar resultados en formato XLSX (Excel), necesita tener <strong>Microsoft Excel instalado</strong> en su sistema.</p>
<ul>
<li>El script funciona con <strong>Excel 2007 o superior</strong></li>
<li><strong>NO es necesario</strong> si solo usa formato CSV</li>
<li>El script autom√°ticamente convierte CSV a XLSX usando Excel COM Automation</li>
</ul>
<h2>üöÄ NUEVAS FUNCIONALIDADES</h2>
<h3>üîê Sistema de Contrase√±a Segura por Defecto</h3>
<p>El script ahora incluye una <strong>contrase√±a por defecto preconfigurada</strong> que se recomienda usar para mayor seguridad y evitar errores de conexi√≥n. Caracter√≠sticas:</p>
<ul>
<li><strong>Valor por defecto:</strong> <code>******</code> (configurable en el c√≥digo)</li>
</ul>
<h3>üìÑ Sistema de Par√°metros para Consultas SQL</h3>
<p><strong>Nueva funcionalidad:</strong> Ahora puede pasar par√°metros din√°micos a sus consultas SQL mediante archivos <code>.txt</code>:</p>
<h4>Estructura de Archivos:</h4>
<pre><code>consultas/
‚îú‚îÄ‚îÄ mi_consulta.sql      # Consulta SQL con variables &amp;parametro
‚îî‚îÄ‚îÄ mi_consulta.txt      # Archivo de par√°metros (mismo nombre base)
</code></pre>
<h4>Formato del Archivo TXT:</h4>
<ul>
<li><strong>Nombres de par√°metros</strong> separados por punto y coma (<code>;</code>)</li>
<li>El script solicitar√° interactivamente los valores de cada par√°metro</li>
</ul>
<p><strong>Ejemplo:</strong></p>
<pre><code class="language-txt"># mi_consulta.txt
departamento;fecha_inicio;fecha_fin
</code></pre>
<h4>Consulta SQL con Variables:</h4>
<pre><code class="language-sql">-- mi_consulta.sql
SELECT * FROM empleados 
WHERE departamento = '&amp;departamento'
  AND fecha_contratacion BETWEEN '&amp;fecha_inicio' AND '&amp;fecha_fin';
</code></pre>
<h4>Flujo de Ejecuci√≥n:</h4>
<ol>
<li>El script detecta <code>mi_consulta.sql</code></li>
<li>Busca autom√°ticamente <code>mi_consulta.txt</code> en la misma carpeta</li>
<li>Lee los nombres de par√°metros del archivo <code>.txt</code></li>
<li>Solicita al usuario los valores para cada par√°metro</li>
<li>Sustituye autom√°ticamente las variables en la consulta SQL</li>
<li>Ejecuta la consulta con los valores ingresados</li>
</ol>
<h3>üîí Validaci√≥n Estricta de Solo SELECT</h3>
<p><strong>Seguridad mejorada:</strong> El script ahora valida autom√°ticamente que los archivos SQL contengan <strong>√∫nicamente consultas SELECT</strong>, bloqueando cualquier operaci√≥n que pueda modificar datos:</p>
<h4>Operaciones Bloqueadas:</h4>
<ul>
<li><strong>DDL:</strong> <code>CREATE</code>, <code>ALTER</code>, <code>DROP</code>, <code>TRUNCATE</code>, <code>RENAME</code></li>
<li><strong>DML:</strong> <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code>, <code>MERGE</code></li>
<li><strong>Control de Transacciones:</strong> <code>COMMIT</code>, <code>ROLLBACK</code>, <code>SAVEPOINT</code></li>
<li><strong>PL/SQL:</strong> <code>BEGIN</code>, <code>END</code>, <code>DECLARE</code>, bloques an√≥nimos</li>
<li><strong>Ejecuci√≥n:</strong> <code>EXECUTE</code>, <code>EXEC</code>, <code>CALL</code></li>
<li><strong>Otros:</strong> <code>GRANT</code>, <code>REVOKE</code>, <code>AUDIT</code>, <code>FLASHBACK</code></li>
</ul>
<h4>Ventajas:</h4>
<ul>
<li><strong>Seguridad:</strong> Previene ejecuci√≥n accidental de operaciones peligrosas</li>
<li><strong>Validaci√≥n inteligente:</strong> Ignora comentarios para evitar falsos positivos</li>
<li><strong>Mensajes claros:</strong> Informa exactamente qu√© operaci√≥n no permitida se detect√≥</li>
<li><strong>Compatibilidad:</strong> Permite <code>WITH</code> (CTE) y consultas complejas v√°lidas</li>
</ul>
<h3>üíæ Compilaci√≥n a Ejecutable (.exe)</h3>
<p>El script puede convertirse a un archivo ejecutable aut√≥nomo:</p>
<h4>Comando de Compilaci√≥n:</h4>
<pre><code class="language-powershell">ps2exe -inputFile .\ejecutar_consultas_oracle.ps1 -outputFile .\ejecutar_consultas_oracle.exe -title &quot;Ejecutor de Consultas Oracle&quot; -version &quot;1.0.0.0&quot; -requireAdmin
</code></pre>
<h4>Caracter√≠sticas del Ejecutable:</h4>
<ul>
<li><strong>Par√°metros preconfigurados:</strong> Incluye contrase√±a por defecto</li>
<li><strong>Sin necesidad de PowerShell:</strong> Ejecutable nativo de Windows</li>
<li><strong>Compatibilidad:</strong> Funciona en cualquier sistema sin requisitos especiales</li>
<li><strong>Seguridad:</strong> Mantiene todas las validaciones del script original</li>
</ul>
<h2>üîê Configuraci√≥n de Permisos de PowerShell</h2>
<h3>¬øPor qu√© es necesario?</h3>
<p>Por defecto, Windows <strong>bloquea la ejecuci√≥n de scripts de PowerShell</strong> por seguridad. Debe otorgar permisos temporales para ejecutar este script.</p>
<h3>Opci√≥n 1: Permitir Ejecuci√≥n Temporal (Recomendado)</h3>
<p>Esta opci√≥n permite ejecutar el script <strong>una sola vez</strong> sin cambiar la configuraci√≥n del sistema:</p>
<ol>
<li><strong>Click derecho</strong> en el archivo <code>ejecutar_consultas_oracle.ps1</code></li>
<li>Seleccione <strong>&quot;Ejecutar con PowerShell&quot;</strong></li>
<li>Si aparece un mensaje de seguridad, seleccione <strong>&quot;Abrir&quot;</strong> o <strong>&quot;Ejecutar de todas formas&quot;</strong></li>
</ol>
<h3>Opci√≥n 2: Cambiar Pol√≠tica de Ejecuci√≥n (Para Uso Frecuente)</h3>
<p>Si planea ejecutar el script m√∫ltiples veces:</p>
<h4><strong>Dar Permisos:</strong></h4>
<ol>
<li>
<p><strong>Abra PowerShell como Administrador:</strong></p>
<ul>
<li>Presione <code>Win + X</code></li>
<li>Seleccione <strong>&quot;Windows PowerShell (Administrador)&quot;</strong> o <strong>&quot;Terminal (Administrador)&quot;</strong></li>
</ul>
</li>
<li>
<p><strong>Ejecute el siguiente comando:</strong></p>
<pre><code class="language-powershell">Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
</code></pre>
</li>
<li>
<p><strong>Confirme con</strong> <code>S</code> (S√≠) cuando se le pregunte</p>
</li>
<li>
<p><strong>Cierre PowerShell</strong></p>
</li>
</ol>
<p><strong>¬øQu√© hace esto?</strong></p>
<ul>
<li>Permite ejecutar scripts locales que usted mismo cre√≥</li>
<li>Mantiene protecci√≥n contra scripts descargados sin firmar</li>
<li>Solo afecta a su usuario, no a todo el sistema</li>
</ul>
<h4><strong>Verificar Pol√≠tica Actual:</strong></h4>
<pre><code class="language-powershell">Get-ExecutionPolicy -List
</code></pre>
<p>Deber√≠a mostrar:</p>
<pre><code>Scope          ExecutionPolicy
-----          ---------------
CurrentUser    RemoteSigned
</code></pre>
<h4><strong>Remover Permisos (Restaurar Seguridad Original):</strong></h4>
<p>Una vez que termine de usar el script, puede restaurar la seguridad original:</p>
<ol>
<li>
<p><strong>Abra PowerShell como Administrador</strong></p>
</li>
<li>
<p><strong>Ejecute:</strong></p>
<pre><code class="language-powershell">Set-ExecutionPolicy -ExecutionPolicy Restricted -Scope CurrentUser
</code></pre>
</li>
<li>
<p><strong>Confirme con</strong> <code>S</code> (S√≠)</p>
</li>
</ol>
<p><strong>Esto volver√° a bloquear todos los scripts de PowerShell para mayor seguridad.</strong></p>
<h3>Opci√≥n 3: Ejecuci√≥n Bypass (Sin Cambiar Configuraci√≥n)</h3>
<p>Ejecutar el script <strong>sin modificar la pol√≠tica</strong> del sistema:</p>
<ol>
<li><strong>Abra PowerShell</strong> (no requiere administrador)</li>
<li><strong>Navegue a la carpeta</strong> donde est√° el script:<pre><code class="language-powershell">cd &quot;C:\Ruta\A\Tu\Carpeta&quot;
</code></pre>
</li>
<li><strong>Ejecute con bypass:</strong><pre><code class="language-powershell">powershell.exe -ExecutionPolicy Bypass -File .\ejecutar_consultas_oracle.ps1
</code></pre>
</li>
</ol>
<h3>‚ö†Ô∏è Soluci√≥n de Problemas con Permisos</h3>
<h4>Error: &quot;No se puede cargar el archivo... porque la ejecuci√≥n de scripts est√° deshabilitada&quot;</h4>
<p><strong>Soluci√≥n:</strong></p>
<ul>
<li>Use la <strong>Opci√≥n 1</strong> (Click derecho &gt; Ejecutar con PowerShell)</li>
<li>O use la <strong>Opci√≥n 2</strong> (Cambiar pol√≠tica de ejecuci√≥n)</li>
<li>O use la <strong>Opci√≥n 3</strong> (Bypass)</li>
</ul>
<h4>Error: &quot;Acceso denegado&quot;</h4>
<p><strong>Soluci√≥n:</strong></p>
<ul>
<li>Aseg√∫rese de ejecutar PowerShell <strong>como Administrador</strong> al cambiar pol√≠ticas</li>
<li>Verifique que tiene permisos sobre la carpeta donde est√° el script</li>
</ul>
<h2>üöÄ Configuraci√≥n del Proyecto</h2>
<h3>Estructura de Carpetas</h3>
<p>Antes de ejecutar el script, debe crear la siguiente estructura de carpetas en el mismo directorio donde se encuentra el archivo <code>.ps1</code>:</p>
<pre><code>üìÅ [Directorio del Script]
‚îú‚îÄ‚îÄ üìÑ ejecutar_consultas_oracle.ps1
‚îú‚îÄ‚îÄ üìÅ consultas/
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ consulta1.sql
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ consulta1.txt           ‚Üê Opcional: par√°metros
‚îÇ   ‚îú‚îÄ‚îÄ üìÑ consulta2.sql
‚îÇ   ‚îî‚îÄ‚îÄ üìÑ ...
‚îî‚îÄ‚îÄ üìÅ resultados/
    ‚îî‚îÄ‚îÄ (aqu√≠ se guardar√°n los archivos generados)
</code></pre>
<h3>Crear las Carpetas</h3>
<h4>Opci√≥n 1: Manualmente</h4>
<ol>
<li>Cree una carpeta llamada <code>consultas</code></li>
<li>Cree una carpeta llamada <code>resultados</code></li>
<li>Ambas deben estar en el mismo directorio que el archivo <code>.ps1</code></li>
</ol>
<h4>Opci√≥n 2: Desde PowerShell</h4>
<pre><code class="language-powershell">New-Item -ItemType Directory -Name &quot;consultas&quot;
New-Item -ItemType Directory -Name &quot;resultados&quot;
</code></pre>
<h4>Opci√≥n 3: Desde CMD</h4>
<pre><code class="language-cmd">mkdir consultas
mkdir resultados
</code></pre>
<h3>Preparar las Consultas SQL</h3>
<h4>Ejemplo B√°sico (sin par√°metros):</h4>
<p><strong>Archivo:</strong> <code>consultas/ventas_2024.sql</code></p>
<pre><code class="language-sql">SELECT 
    cliente_id,
    nombre_cliente,
    SUM(monto) as total_ventas
FROM ventas
WHERE fecha &gt;= TO_DATE('2024-01-01', 'YYYY-MM-DD')
GROUP BY cliente_id, nombre_cliente
ORDER BY total_ventas DESC;
</code></pre>
<h4>Ejemplo con Par√°metros:</h4>
<p><strong>Archivo SQL:</strong> <code>consultas/empleados_por_departamento.sql</code></p>
<pre><code class="language-sql">SELECT 
    empleado_id,
    nombre_completo,
    fecha_contratacion,
    salario
FROM empleados
WHERE departamento = '&amp;departamento'
  AND fecha_contratacion &gt; '&amp;fecha_minima';
</code></pre>
<p><strong>Archivo TXT (par√°metros):</strong> <code>consultas/empleados_por_departamento.txt</code></p>
<pre><code>departamento;fecha_minima
</code></pre>
<p><strong>IMPORTANTE:</strong></p>
<ul>
<li>Solo escriba la consulta SELECT (o DML)</li>
<li>El script autom√°ticamente agrega los comandos necesarios para formatear y exportar los resultados</li>
<li>Use variables con formato <code>&amp;nombre_parametro</code> en la consulta SQL</li>
<li>Los nombres de par√°metros en el archivo <code>.txt</code> deben coincidir exactamente con los nombres de las variables</li>
</ul>
<h2>üíª Uso del Script</h2>
<h3>Ejecutar el Script</h3>
<h4>M√©todo 1: Click Derecho (M√°s Simple)</h4>
<ol>
<li><strong>Click derecho</strong> en <code>ejecutar_consultas_oracle.ps1</code></li>
<li>Seleccione <strong>&quot;Ejecutar con PowerShell&quot;</strong></li>
<li>Se abrir√° una ventana de PowerShell</li>
</ol>
<h4>M√©todo 2: Desde PowerShell</h4>
<ol>
<li><strong>Abra PowerShell</strong></li>
<li><strong>Navegue al directorio:</strong><pre><code class="language-powershell">cd &quot;C:\Ruta\Donde\Esta\El\Script&quot;
</code></pre>
</li>
<li><strong>Ejecute:</strong><pre><code class="language-powershell">.\ejecutar_consultas_oracle.ps1
</code></pre>
</li>
</ol>
<h4>M√©todo 3: Ejecutable Compilado (.exe)</h4>
<ol>
<li><strong>Doble click</strong> en <code>ejecutar_consultas_oracle.exe</code></li>
</ol>
<h3>Datos de Entrada Requeridos</h3>
<p>El script solicitar√° los siguientes datos <strong>uno por uno</strong>:</p>
<h4>1. Usuario de Oracle</h4>
<pre><code>Ingrese el usuario de Oracle: hr_user
</code></pre>
<ul>
<li>Ingrese el nombre de usuario de su base de datos Oracle</li>
<li>Presione <strong>ENTER</strong></li>
</ul>
<h4>2. Contrase√±a (Sistema Mejorado)</h4>
<pre><code>Opciones de contrasena:
  1. Usar contrasena por defecto (RECOMENDADO)
  2. Ingresar contrasena personalizada

[ADVERTENCIA] La opcion por defecto es mas segura y evita errores de conexion.

Seleccione opcion de contrasena (1 o 2) [Por defecto: 1]: 
</code></pre>
<p><strong>Si selecciona Opci√≥n 1:</strong></p>
<pre><code>[OK] Usando contrasena por defecto
</code></pre>
<p><strong>Si selecciona Opci√≥n 2:</strong></p>
<pre><code>Ingrese la contrasena personalizada: ************
[OK] Contrasena personalizada configurada
</code></pre>
<h4>3. Host</h4>
<pre><code>Ingrese el host (ej: localhost, 192.168.1.100): 192.168.1.100
</code></pre>
<ul>
<li>Ingrese la direcci√≥n IP o nombre del servidor Oracle</li>
<li>Ejemplos: <code>localhost</code>, <code>192.168.1.100</code>, <code>oracle.empresa.com</code></li>
<li>Presione <strong>ENTER</strong></li>
</ul>
<h4>4. Puerto</h4>
<pre><code>Ingrese el puerto (ej: 1521): 1521
</code></pre>
<ul>
<li>Ingrese el puerto de conexi√≥n (por defecto Oracle usa <strong>1521</strong>)</li>
<li><strong>Debe ser un n√∫mero entre 1 y 65535</strong></li>
<li>Presione <strong>ENTER</strong></li>
</ul>
<h4>5. SID o Service Name</h4>
<pre><code>Ingrese el SID o Service Name (ej: ORCL, XE, PDB1): ORCL
</code></pre>
<ul>
<li>Ingrese el SID o nombre del servicio de su base de datos</li>
<li>Ejemplos: <code>ORCL</code>, <code>XE</code>, <code>PROD</code>, <code>pdborcl</code></li>
<li>Presione <strong>ENTER</strong></li>
</ul>
<h4>6. Formato de Salida</h4>
<pre><code>Formato de salida (1=CSV, 2=XLSX/Excel) [Por defecto: 1]: 1
</code></pre>
<ul>
<li>Ingrese <strong>1</strong> para exportar a CSV (predeterminado)</li>
<li>Ingrese <strong>2</strong> para exportar a XLSX/Excel (<strong>requiere Microsoft Excel instalado</strong>)</li>
<li>Si presiona ENTER sin escribir nada, se usar√° CSV por defecto</li>
</ul>
<h3>Proceso de Ejecuci√≥n</h3>
<p>Una vez ingresados todos los datos:</p>
<ol>
<li>El script <strong>verifica</strong> la existencia de las carpetas <code>consultas</code> y <code>resultados</code></li>
<li>Si faltan carpetas, muestra un error y espera que presione ENTER</li>
<li>Busca la instalaci√≥n de Oracle SQLcl en las rutas est√°ndar</li>
<li><strong>Configura variables de entorno Java</strong> para evitar warnings</li>
<li><strong>Valida la conexi√≥n</strong> a Oracle antes de procesar consultas</li>
<li>Cuenta cu√°ntos archivos <code>.sql</code> hay en la carpeta <code>consultas</code></li>
<li><strong>Procesa cada consulta</strong> una por una:
<ul>
<li><strong>VALIDACI√ìN:</strong> Verifica que sea solo consulta SELECT</li>
<li><strong>PAR√ÅMETROS:</strong> Si existe archivo <code>.txt</code>, solicita valores de par√°metros</li>
<li><strong>CONEXI√ìN:</strong> Conecta a Oracle con las credenciales proporcionadas</li>
<li><strong>EJECUCI√ìN:</strong> Ejecuta la consulta SQL con par√°metros sustituidos</li>
<li><strong>EXPORTACI√ìN:</strong> Exporta los resultados con un nombre √∫nico</li>
<li>Si eligi√≥ XLSX, convierte autom√°ticamente de CSV a Excel</li>
</ul>
</li>
<li>Muestra un resumen del procesamiento con colores</li>
<li><strong>Siempre espera</strong> que presione ENTER antes de cerrar</li>
</ol>
<h3>Ejemplo Completo con Par√°metros</h3>
<h4>Archivo de Consulta:</h4>
<p><strong><code>consultas/ventas_por_periodo.sql</code>:</strong></p>
<pre><code class="language-sql">SELECT 
    producto_id,
    nombre_producto,
    SUM(cantidad) as unidades_vendidas,
    SUM(total) as ingresos_totales
FROM ventas_detalle
WHERE fecha_venta BETWEEN '&amp;fecha_inicio' AND '&amp;fecha_fin'
  AND region = '&amp;region'
GROUP BY producto_id, nombre_producto
ORDER BY ingresos_totales DESC;
</code></pre>
<h4>Archivo de Par√°metros:</h4>
<p><strong><code>consultas/ventas_por_periodo.txt</code>:</strong></p>
<pre><code>fecha_inicio;fecha_fin;region
</code></pre>
<h4>Ejecuci√≥n del Script:</h4>
<pre><code>Procesando: ventas_por_periodo.sql
  &gt; Salida: ventas_por_periodo_20241218_143022.csv
  &gt; Leyendo definiciones de parametros desde: ventas_por_periodo.txt
  Ingrese valor para 'fecha_inicio': 2024-01-01
  Ingrese valor para 'fecha_fin': 2024-12-31
  Ingrese valor para 'region': Norte
  &gt; Validando que sea solo consulta SELECT...
  [OK] Validacion de SELECT exitosa
  &gt; Ejecutando consulta (timeout: 30 minutos)...
  [OK] Archivo CSV generado: ventas_por_periodo_20241218_143022.csv
</code></pre>
<h3>Nombres de Archivos de Salida</h3>
<p>Los archivos de resultados se guardan con el siguiente formato:</p>
<pre><code>[nombre_consulta]_[fecha]_[hora].[extensi√≥n]
</code></pre>
<p><strong>Ejemplos:</strong></p>
<ul>
<li><code>ventas_2024_20241217_143055.csv</code></li>
<li><code>clientes_activos_20241217_144512.xlsx</code></li>
</ul>
<p>Esto permite:</p>
<ul>
<li>Identificar f√°cilmente qu√© consulta gener√≥ el resultado</li>
<li>Mantener un historial de ejecuciones</li>
<li>Evitar sobrescribir archivos anteriores</li>
<li>Timestamp con segundos para mayor precisi√≥n</li>
</ul>
<h2>‚ö†Ô∏è Manejo de Errores con Try/Catch/Finally</h2>
<p>El script utiliza el sistema <strong>nativo de PowerShell</strong> para manejo de errores:</p>
<h3>Try Block</h3>
<p>Contiene toda la l√≥gica principal del script</p>
<h3>Catch Block</h3>
<p>Captura <strong>cualquier error</strong> que ocurra y muestra:</p>
<ul>
<li>Mensaje de error cr√≠tico</li>
<li>Detalles del error espec√≠fico</li>
<li>Estado final del script</li>
</ul>
<h3>Finally Block</h3>
<p><strong>SIEMPRE se ejecuta</strong>, sin importar si hubo error o no:</p>
<ul>
<li>Muestra mensaje de cierre</li>
<li><strong>Espera ENTER antes de cerrar</strong></li>
<li>Garantiza que la ventana no se cierre abruptamente</li>
</ul>
<h2>‚ùå Errores Comunes</h2>
<h3>El script NO se cierra autom√°ticamente en caso de error</h3>
<p>Todos los errores mostrar√°n un mensaje descriptivo y <strong>siempre</strong> esperar√°n que presione <strong>ENTER</strong> para cerrar la ventana.</p>
<h3>Errores de Validaci√≥n</h3>
<h4>Error: Campo vac√≠o</h4>
<pre><code>[ERROR] El usuario no puede estar vacio
</code></pre>
<p><strong>Soluci√≥n:</strong> Ingrese un valor v√°lido</p>
<h4>Error: Puerto inv√°lido</h4>
<pre><code>[ERROR] El puerto debe ser un numero valido
</code></pre>
<p><strong>Soluci√≥n:</strong> Ingrese solo n√∫meros (ejemplo: 1521)</p>
<pre><code>[ERROR] El puerto debe estar entre 1 y 65535
</code></pre>
<p><strong>Soluci√≥n:</strong> Ingrese un puerto en el rango v√°lido</p>
<h4>Error: Script SQL inv√°lido (contiene operaciones no SELECT)</h4>
<pre><code>Procesando: consulta_peligrosa.sql
  &gt; Salida: consulta_peligrosa_20241218_143022.csv
  &gt; Validando que sea solo consulta SELECT...
  [ERROR] Script SQL invalido
  Razon: Contiene operacion no permitida: UPDATE
  Este script solo permite consultas SELECT.
  Operaciones prohibidas: INSERT, UPDATE, DELETE, DROP, TRUNCATE, CREATE, ALTER, PL/SQL, etc.
</code></pre>
<p><strong>Soluci√≥n:</strong> Revise el archivo SQL y aseg√∫rese de que solo contenga consultas SELECT.</p>
<h3>Errores de Configuraci√≥n</h3>
<h4>Error: Carpeta &quot;consultas&quot; no encontrada</h4>
<pre><code>[ERROR] No se encontro la carpeta 'consultas'

Por favor, cree la carpeta 'consultas' en el mismo directorio donde esta este script
y coloque sus archivos .sql dentro de ella.
</code></pre>
<p><strong>Soluci√≥n:</strong> Cree la carpeta <code>consultas</code> y vuelva a ejecutar el script.</p>
<h4>Error: Carpeta &quot;resultados&quot; no encontrada</h4>
<pre><code>[ERROR] No se encontro la carpeta 'resultados'

Por favor, cree la carpeta 'resultados' en el mismo directorio donde esta este script.
Esta carpeta se utilizara para guardar los resultados de las consultas.
</code></pre>
<p><strong>Soluci√≥n:</strong> Cree la carpeta <code>resultados</code> y vuelva a ejecutar el script.</p>
<h4>Error: Oracle SQLcl no encontrado</h4>
<pre><code>[ERROR] No se pudo encontrar Oracle SQLcl instalado

Rutas buscadas:
  - C:\oracle\sqlcl\bin\sql.exe
  - C:\Program Files\Oracle\sqlcl\bin\sql.exe
  - %USERPROFILE%\sqlcl\bin\sql.exe
  - %ORACLE_HOME%\sqlcl\bin\sql.exe
  - Variable PATH del sistema

Por favor, descargue e instale Oracle SQLcl desde:
https://www.oracle.com/database/sqldeveloper/technologies/sqlcl/download/
</code></pre>
<p><strong>Soluci√≥n:</strong> Descargue e instale Oracle SQLcl siguiendo las instrucciones de este README.</p>
<h4>Error: Java no encontrado o versi√≥n incorrecta</h4>
<pre><code>Error: Java no est√° instalado o la versi√≥n es incorrecta
SQLcl requiere Java 17 o superior
</code></pre>
<p><strong>Soluci√≥n:</strong></p>
<ol>
<li>Instale Java 17 o superior (ver secci√≥n &quot;Java Runtime Environment&quot;)</li>
<li>Configure JAVA_HOME correctamente</li>
<li>Agregue <code>%JAVA_HOME%\bin</code> al PATH</li>
<li>Abra una nueva ventana de PowerShell y verifique: <code>java -version</code></li>
</ol>
<h3>Errores de Conexi√≥n</h3>
<h4>Error: No se puede conectar a Oracle</h4>
<pre><code>[ERROR] No se pudo establecer conexion con Oracle

Verifique los siguientes datos:
  - Usuario: admin_ventas
  - Host: db-server.empresa.com
  - Puerto: 1521
  - SID/Service: PRODDB

Posibles causas:
  - Credenciales incorrectas
  - Servidor Oracle no accesible
  - Firewall bloqueando la conexion
  - SID o Service Name incorrecto
</code></pre>
<p><strong>Soluciones:</strong></p>
<ol>
<li>Verifique que las credenciales sean correctas</li>
<li>Pruebe hacer ping al servidor: <code>ping db-server.empresa.com</code></li>
<li>Verifique que el firewall permita conexiones al puerto Oracle</li>
<li>Confirme el SID/Service Name correcto con el administrador de BD</li>
<li>Intente conectarse manualmente con SQLcl:<pre><code>sql usuario/password@host:puerto/servicio
</code></pre>
</li>
</ol>
<h4>Advertencia: No hay archivos SQL</h4>
<pre><code>[ADVERTENCIA] No se encontraron archivos .sql en la carpeta 'consultas'

Por favor, agregue sus consultas SQL en la carpeta 'consultas' y vuelva a ejecutar el script.
</code></pre>
<p><strong>Soluci√≥n:</strong> Agregue al menos un archivo <code>.sql</code> en la carpeta <code>consultas</code>.</p>
<h3>Errores Durante Ejecuci√≥n</h3>
<h4>Error al ejecutar consulta espec√≠fica</h4>
<pre><code>Procesando: consulta_invalida.sql
  &gt; Salida: consulta_invalida_20241217_1430.csv
  [ERROR] Fallo la ejecucion de la consulta
  Detalles: ORA-00942: table or view does not exist
</code></pre>
<p><strong>Posibles causas:</strong></p>
<ul>
<li>Sintaxis SQL incorrecta</li>
<li>Tabla o columna no existe</li>
<li>Permisos insuficientes sobre objetos de BD</li>
<li>Consulta demasiado larga (timeout)</li>
</ul>
<p><strong>Soluci√≥n:</strong></p>
<ul>
<li>Pruebe la consulta manualmente en SQLcl primero</li>
<li>Revise los permisos del usuario en Oracle</li>
<li>Simplifique consultas muy complejas</li>
</ul>
<h4>Error al convertir a Excel</h4>
<pre><code>[ERROR] Fallo la conversion a Excel
Detalles: ...
Nota: Se requiere Microsoft Excel instalado para exportar a XLSX
</code></pre>
<p><strong>Posibles causas:</strong></p>
<ul>
<li>Microsoft Excel no est√° instalado</li>
<li>Excel est√° abierto y bloqueando archivos</li>
<li>Permisos insuficientes para crear archivos COM</li>
</ul>
<p><strong>Soluci√≥n:</strong></p>
<ol>
<li>Instale Microsoft Excel 2007 o superior</li>
<li>Cierre todas las instancias de Excel antes de ejecutar el script</li>
<li>Use formato CSV si no tiene Excel instalado</li>
<li>Ejecute PowerShell como administrador si hay problemas de permisos</li>
</ol>
<h2>üìä Ejemplo Completo de Uso</h2>
<h3>Paso a Paso</h3>
<ol>
<li>
<p><strong>Instalar Java 17 o superior</strong></p>
<ul>
<li>Descargue desde: https://adoptium.net/ (recomendado) o https://www.oracle.com/java/technologies/downloads/</li>
<li>Instale y configure JAVA_HOME</li>
<li>Agregue <code>%JAVA_HOME%\bin</code> al PATH</li>
<li>Verifique: <code>java -version</code></li>
</ul>
</li>
<li>
<p><strong>Descargar e instalar Oracle SQLcl</strong></p>
<ul>
<li>Descargue desde: https://www.oracle.com/database/sqldeveloper/technologies/sqlcl/download/</li>
<li>Extraiga a <code>C:\oracle\sqlcl\</code></li>
<li>Verifique: <code>C:\oracle\sqlcl\bin\sql.exe -V</code></li>
</ul>
</li>
<li>
<p><strong>Configurar permisos de PowerShell</strong> (Opci√≥n 2):</p>
<pre><code class="language-powershell">Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
</code></pre>
</li>
<li>
<p><strong>Crear estructura de carpetas:</strong></p>
<pre><code>C:\MisConsultas\
‚îú‚îÄ‚îÄ ejecutar_consultas_oracle.ps1
‚îú‚îÄ‚îÄ consultas\
‚îî‚îÄ‚îÄ resultados\
</code></pre>
</li>
<li>
<p><strong>Agregar consultas SQL</strong> en <code>C:\MisConsultas\consultas\</code>:</p>
<ul>
<li><code>ventas_mensuales.sql</code></li>
<li><code>top_clientes.sql</code></li>
<li><code>inventario_actual.sql</code></li>
</ul>
</li>
<li>
<p><strong>Agregar archivos de par√°metros</strong> (opcional):</p>
<ul>
<li><code>ventas_mensuales.txt</code> con contenido: <code>anio;mes</code></li>
<li><code>top_clientes.txt</code> con contenido: <code>limite_registros</code></li>
</ul>
</li>
<li>
<p><strong>Ejecutar el script:</strong></p>
<ul>
<li>Click derecho en <code>ejecutar_consultas_oracle.ps1</code></li>
<li>&quot;Ejecutar con PowerShell&quot;</li>
</ul>
</li>
<li>
<p><strong>Ingresar datos:</strong></p>
<pre><code>Usuario: admin_ventas
Opcion de contrasena: 1
Host: db-server.empresa.com
Puerto: 1521
SID/Service: PRODDB
Formato: 1
</code></pre>
</li>
<li>
<p><strong>Ingresar par√°metros</strong> (si aplica):</p>
<pre><code>Para consulta 'ventas_mensuales.sql':
Ingrese valor para 'anio': 2024
Ingrese valor para 'mes': 12
</code></pre>
</li>
<li>
<p><strong>Ver resultados</strong> en <code>C:\MisConsultas\resultados\</code>:</p>
<pre><code>ventas_mensuales_20241217_150033.csv
top_clientes_20241217_150033.csv
inventario_actual_20241217_150033.csv
</code></pre>
<p>O si eligi√≥ Excel (opci√≥n 2):</p>
<pre><code>ventas_mensuales_20241217_150033.xlsx
top_clientes_20241217_150033.xlsx
inventario_actual_20241217_150033.xlsx
</code></pre>
</li>
<li>
<p><strong>Opcional - Restaurar seguridad:</strong></p>
<pre><code class="language-powershell">Set-ExecutionPolicy -ExecutionPolicy Restricted -Scope CurrentUser
</code></pre>
</li>
</ol>
<h2>üîß Soluci√≥n de Problemas</h2>
<h3>El script no se ejecuta (Error de Pol√≠tica)</h3>
<ul>
<li>Siga la secci√≥n <strong>&quot;Configuraci√≥n de Permisos de PowerShell&quot;</strong></li>
<li>Use el m√©todo de <strong>Bypass</strong> si no puede cambiar pol√≠ticas</li>
</ul>
<h3>Java no funciona o no se encuentra</h3>
<ul>
<li>Verifique que instal√≥ Java 17 o superior: <code>java -version</code></li>
<li>Verifique JAVA_HOME: <code>echo $env:JAVA_HOME</code></li>
<li>Verifique PATH: <code>echo $env:PATH</code> (debe contener <code>%JAVA_HOME%\bin</code>)</li>
<li>Abra una NUEVA ventana de PowerShell despu√©s de configurar variables</li>
<li>Si tiene m√∫ltiples versiones, aseg√∫rese de que Java 17+ est√© primero en PATH</li>
</ul>
<h3>SQLcl no se encuentra</h3>
<ul>
<li>Verifique que extrajo SQLcl correctamente</li>
<li>Aseg√∫rese de que <code>sql.exe</code> existe en <code>bin\</code></li>
<li>Verifique que Java est√° funcionando antes de ejecutar SQLcl</li>
<li>Intente agregar la ruta al PATH del sistema</li>
</ul>
<h3>SQLcl no inicia (Error de Java)</h3>
<ul>
<li>Ejecute: <code>C:\oracle\sqlcl\bin\sql.exe -V</code></li>
<li>Si falla, verifique que Java 17+ est√° instalado</li>
<li>Aseg√∫rese de que JAVA_HOME apunta a una instalaci√≥n v√°lida de Java</li>
</ul>
<h3>Problemas de conexi√≥n a Oracle</h3>
<ul>
<li>Verifique que el servidor Oracle est√© accesible desde su red</li>
<li>Pruebe la conexi√≥n manualmente con SQLcl primero:<pre><code>sql usuario/password@host:puerto/servicio
</code></pre>
</li>
<li>Verifique configuraciones de firewall y TNS</li>
</ul>
<h3>Archivos con espacios en el nombre</h3>
<ul>
<li>PowerShell y SQLcl manejan correctamente nombres con espacios</li>
<li>No es necesario renombrar archivos</li>
</ul>
<h3>Consultas muy grandes</h3>
<ul>
<li>SQLcl puede tardar con consultas que devuelven muchos registros</li>
<li>El script mostrar√° el progreso en tiempo real</li>
</ul>
<h3>Formato CSV no se ve bien</h3>
<ul>
<li>Abra el CSV con un editor de texto primero</li>
<li>Aseg√∫rese de que su Excel est√© configurado para UTF-8</li>
<li>Use &quot;Importar datos&quot; en Excel en lugar de doble click</li>
</ul>
<h3>Problemas con exportaci√≥n a Excel (XLSX)</h3>
<ul>
<li><strong>Requiere Microsoft Excel instalado</strong> en el sistema</li>
<li>Cierre todas las instancias de Excel antes de ejecutar el script</li>
<li>Si no tiene Excel, use formato CSV (opci√≥n 1)</li>
<li>El script convierte autom√°ticamente CSV a XLSX usando Excel COM</li>
</ul>
<h3>La ventana se cierra inmediatamente</h3>
<ul>
<li><strong>Nunca deber√≠a ocurrir</strong> gracias al bloque <code>finally</code></li>
<li>Si ocurre, ejecute desde PowerShell directamente para ver el error</li>
</ul>
<h3>Problemas con par√°metros</h3>
<ul>
<li><strong>Los nombres en el .txt deben coincidir</strong> exactamente con los nombres de variables en el SQL</li>
<li>Use solo letras, n√∫meros y guiones bajos en nombres de par√°metros</li>
<li>El archivo .txt debe usar codificaci√≥n UTF-8 sin BOM</li>
<li>Aseg√∫rese de que el archivo .txt no tenga espacios adicionales al final de las l√≠neas</li>
</ul>
<h2>üé® Caracter√≠sticas del Script PowerShell</h2>
<h3>Ventajas de Usar SQLcl</h3>
<p>‚úÖ <strong>Gratuito y ligero</strong> - No requiere Oracle Client completo<br>
‚úÖ <strong>Multiplataforma</strong> - Funciona en Windows, Linux, Mac<br>
‚úÖ <strong>Formato CSV nativo</strong> - Exportaci√≥n directa y eficiente<br>
‚úÖ <strong>R√°pido y eficiente</strong> - Mejor rendimiento que SQL*Plus<br>
‚úÖ <strong>Actualizado</strong> - Soporta las √∫ltimas versiones de Oracle<br>
‚úÖ <strong>Sin instalaci√≥n compleja</strong> - Solo extraer y usar</p>
<h3>C√≥mo Funciona la Exportaci√≥n a Excel</h3>
<ol>
<li><strong>SQLcl exporta a CSV</strong>: Oracle SQLcl genera el archivo CSV (formato nativo)</li>
<li><strong>PowerShell convierte a XLSX</strong>: Si eligi√≥ Excel, el script usa COM Automation para convertir</li>
<li><strong>Resultado final</strong>: Archivo Excel nativo (.xlsx) listo para usar</li>
</ol>
<p><strong>Nota:</strong> La conversi√≥n a XLSX requiere Microsoft Excel instalado. Si no lo tiene, use CSV que es universalmente compatible.</p>
<h3>Ventajas del Script PowerShell</h3>
<p>‚úÖ <strong>Try/Catch/Finally nativo</strong> - Manejo robusto de errores<br>
‚úÖ <strong>Validaci√≥n de tipos</strong> - Puerto debe ser n√∫mero<br>
‚úÖ <strong>Colores en consola</strong> - Mejor experiencia visual<br>
‚úÖ <strong>Mejor manejo de strings</strong> - Sin problemas con espacios<br>
‚úÖ <strong>Objetos y propiedades</strong> - C√≥digo m√°s limpio<br>
‚úÖ <strong>Contrase√±a enmascarada</strong> - Mayor seguridad<br>
‚úÖ <strong>Conversi√≥n autom√°tica a Excel</strong> - CSV a XLSX con un click<br>
‚úÖ <strong>Validaci√≥n de solo SELECT</strong> - Seguridad mejorada<br>
‚úÖ <strong>Par√°metros din√°micos</strong> - Consultas parametrizadas flexibles<br>
‚úÖ <strong>Contrase√±a por defecto</strong> - Configuraci√≥n simplificada</p>
<h3>Colores Utilizados</h3>
<ul>
<li><strong>Cyan</strong>: T√≠tulos y encabezados</li>
<li><strong>Yellow</strong>: Advertencias y configuraci√≥n</li>
<li><strong>Green</strong>: √âxito y confirmaciones</li>
<li><strong>Red</strong>: Errores cr√≠ticos</li>
<li><strong>Gray</strong>: Informaci√≥n secundaria</li>
<li><strong>White</strong>: Informaci√≥n principal</li>
</ul>
<h2>üìù Notas Adicionales</h2>
<ul>
<li>El script utiliza codificaci√≥n <strong>UTF-8</strong> para soportar caracteres especiales</li>
<li>Cada ejecuci√≥n del script es independiente (no guarda estado entre ejecuciones)</li>
<li>Los archivos de resultados <strong>nunca se sobrescriben</strong> gracias al timestamp √∫nico con segundos</li>
<li>Se recomienda <strong>probar las consultas manualmente</strong> en SQLcl antes de usar el script</li>
<li>El script es compatible con <strong>Oracle 11g, 12c, 18c, 19c, 21c y 23c</strong></li>
<li>PowerShell 5.1 viene <strong>preinstalado</strong> en Windows 10 y 11</li>
<li>SQLcl requiere Java, pero viene incluido en el paquete</li>
<li>La conversi√≥n a XLSX usa <strong>Excel COM Automation</strong> (requiere Excel instalado)</li>
<li>Formato CSV funciona sin necesidad de Microsoft Excel</li>
</ul>
<h2>üîí Seguridad y Mejores Pr√°cticas</h2>
<h3>Recomendaciones de Seguridad</h3>
<ol>
<li>
<p><strong>Credenciales:</strong></p>
<ul>
<li>La <strong>contrase√±a por defecto</strong> es m√°s segura para entornos controlados</li>
<li>Nunca guarde contrase√±as en el script o archivos de texto plano</li>
<li>La contrase√±a se enmascara autom√°ticamente durante la entrada</li>
<li>Considere usar Oracle Wallet para credenciales frecuentes</li>
</ul>
</li>
<li>
<p><strong>Validaci√≥n de Consultas:</strong></p>
<ul>
<li>El script valida autom√°ticamente que solo sean consultas SELECT</li>
<li>Revise todas las consultas antes de ejecutarlas</li>
<li>Evite consultas con <code>DELETE</code> o <code>UPDATE</code> sin <code>WHERE</code></li>
<li>Use permisos de solo lectura cuando sea posible</li>
</ul>
</li>
<li>
<p><strong>Par√°metros:</strong></p>
<ul>
<li>Los archivos .txt solo contienen nombres de par√°metros, no valores</li>
<li>Los valores se solicitan interactivamente y no se almacenan</li>
<li>Use nombres descriptivos para los par√°metros</li>
</ul>
</li>
<li>
<p><strong>Permisos de PowerShell:</strong></p>
<ul>
<li>Use <code>RemoteSigned</code> en lugar de <code>Unrestricted</code></li>
<li>Restaure a <code>Restricted</code> cuando termine de usar el script</li>
</ul>
</li>
<li>
<p><strong>Exportaci√≥n a Excel:</strong></p>
<ul>
<li>Si usa formato XLSX, aseg√∫rese de cerrar Excel antes de ejecutar</li>
<li>Los archivos Excel pueden ser m√°s grandes que CSV</li>
<li>CSV es m√°s seguro y portable si no necesita formato espec√≠fico</li>
</ul>
</li>
<li>
<p><strong>Red:</strong></p>
<ul>
<li>Use conexiones seguras (Oracle Advanced Security)</li>
<li>Considere VPN para conexiones remotas</li>
<li>Verifique configuraciones de firewall</li>
</ul>
</li>
</ol>
<h2>üÜö Comparaci√≥n: SQLcl vs SQL*Plus</h2>
<table>
<thead>
<tr>
<th>Caracter√≠stica</th>
<th>SQLcl</th>
<th>SQL*Plus</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Gratuito</strong></td>
<td>‚úÖ S√≠</td>
<td>‚úÖ S√≠</td>
</tr>
<tr>
<td><strong>Formato CSV</strong></td>
<td>‚úÖ Nativo</td>
<td>‚ö†Ô∏è Manual</td>
</tr>
<tr>
<td><strong>Formato Excel</strong></td>
<td>‚ö†Ô∏è Via conversi√≥n</td>
<td>‚ùå No</td>
</tr>
<tr>
<td><strong>Instalaci√≥n</strong></td>
<td>‚úÖ Extraer ZIP</td>
<td>‚ö†Ô∏è Requiere Oracle Client</td>
</tr>
<tr>
<td><strong>Tama√±o</strong></td>
<td>~50 MB</td>
<td>~200+ MB</td>
</tr>
<tr>
<td><strong>Scripting</strong></td>
<td>‚úÖ Excelente</td>
<td>‚úÖ Bueno</td>
</tr>
<tr>
<td><strong>Multiplataforma</strong></td>
<td>‚úÖ S√≠</td>
<td>‚úÖ S√≠</td>
</tr>
<tr>
<td><strong>Moderno</strong></td>
<td>‚úÖ S√≠</td>
<td>‚ùå Antiguo</td>
</tr>
<tr>
<td><strong>Automatizaci√≥n</strong></td>
<td>‚úÖ Excelente</td>
<td>‚úÖ Bueno</td>
</tr>
<tr>
<td><strong>Validaci√≥n SQL</strong></td>
<td>‚úÖ Con este script</td>
<td>‚ùå No</td>
</tr>
</tbody>
</table>
<p><strong>Conclusi√≥n:</strong> SQLcl es la mejor opci√≥n para automatizaci√≥n moderna con Oracle.</p>
<h2>üìÑ Licencia</h2>
<p>Este script es de uso libre. Oracle SQLcl est√° bajo licencia Oracle Technology Network License Agreement.</p>
<h2>ü§ù Contribuciones</h2>
<p>Para reportar problemas o sugerir mejoras, por favor contacte al desarrollador del proyecto.</p>
<hr>
<p><strong>Versi√≥n del Script:</strong> 4.0 (PowerShell + Oracle SQLcl)<br>
<strong>Caracter√≠sticas Principales:</strong> Validaci√≥n SELECT, par√°metros din√°micos, contrase√±a por defecto<br>
<strong>Fecha:</strong> Diciembre 2025<br>
<strong>Compatible con:</strong> Oracle SQLcl 23.x+, Windows 10+, PowerShell 5.1+, Oracle 11g-23c</p>
</body>
</html>